---
title: 'Mushroom and Stomach Cancer: Meta-analysis'
output:
  html_document:
    df_print: paged
---


# LOAD REQUIRED PACKAGES AND FUNCTIONS -----------------------------------------
```{r, message=FALSE}
library(olsrr) # linear regression
library(tidyverse) # general stuff
library(hrbrthemes) # pretty plots
library(ggplot2) # pretty plots
library(plotly) # interactive plots
library(gapminder) # interactive plots
library(pastecs) # stat.desc
library(metafor) # for meta-analysis: mixed-effects logistic and Poisson regression models
library(meta) # meta-regression, GLMM, forest plots,(subgroup) meta-analyses.
library(sp) # spatial data
library(rgdal) #  projection/transformation operations for shapefiles
library(sf) # Simple Features for R
library(rnaturalearth)
library(tmap) # cool maps
library(ggpubr) # 'ggplot2' Based Publication Ready Plots
library(ggpmisc) #Miscellaneous Extensions to 'ggplot2'
library(spData)
library(cowplot)# plot grid
library(ggsci)
library(RColorBrewer)
library(ggrepel)
library(readxl)
```

# Objectives:
## Determine the association between mushroom consumption and stomach cancer
## Characterize the modifiers for the mushroom-stomach cancer
## Factors to explore: WHO region, Study design, Smoking and H.pylori rates, Income group, Mean age, proportion male


# read data -----------------------------------------
```{r}
rm(list=ls())
#dat1=read.csv("Main.csv")
#dat=read.csv("data/stop2_updated.csv")
dat=read.csv("data/stop2_updated.csv")
dat$Female_Smoke=dat$Smoking_F/5
dat$Male_Smoke=dat$Smoking_M/5
dat$TotalSmoke=dat$Smoking_Mean/5
dat$hpylori_5=dat$HPYLORI/5
dat$Male_Scaled=dat$Perc_Male/5
dat$Age_centered=dat$Mean_age-mean(dat$Mean_age)
```


# Meta-analysis using Maximum likehood Adjusted-----------------------------------------
```{r}
dat$TE=log(dat$RR)
#dat$seTE=(log(dat$RR_U-log(dat$RR_L))/(3.92))

dat$lower <- log(dat$RR_L)
dat$upper <- log(dat$RR_U)
dat$seTE <- (dat$upper - dat$lower)/3.92



#l1=is.na(dat$CRR)
#dat=dat[!l1,]


#dat$TE=log(dat$CRR)
#dat$seTE=(log(dat$CRR_U-log(dat$CRR_L))/(3.92))



m <- metagen(TE,
             seTE,
             data=dat,
             #studlab=paste(Study,Age,Male, Country,sep = ","),
             studlab=paste(Study),
             comb.fixed = T,
             comb.random = T,
             hakn = F,
             prediction=F,
             sm="RR")

m

```


# Meta-analysis using Maximum likehood UnAdjusted-----------------------------------------
```{r, eval=F}

l1=is.na(dat$CRR)
dat=dat[!l1,]

dat$TE=log(dat$CRR)
#dat$seTE=(log(dat$RR_U-log(dat$RR_L))/(3.92))

dat$lower <- log(dat$CRR_L)

dat$upper <- log(dat$CRR_U)

dat$seTE <- (dat$upper - dat$lower)/3.92

m <- metagen(TE,
             seTE,
             data=dat,
             #studlab=paste(Study,Age,Male, Country,sep = ","),
             studlab=paste(Study),
             comb.fixed = T,
             comb.random = T,
             hakn = F,
             prediction=F,
             sm="RR")

m

```












#Influence analysis  using leave-one-out -----------------------------------------
```{r}
pdf("figs/InfluencialPlots.pdf", width = 10, height = 20)
forest(metainf(m, pooled = "random"))
dev.off()

inf1=metainf(m, pooled = "random")
summary(inf1)
```


```{r fig.height=3, fig.width=4, echo=FALSE,warning=FALSE}
forest(inf1,
       leftlabs = c("Study"),
       digits = 2,
       col.by="black",
       #sortvar = "TE",
       squaresize=0.5,
       col.square="blue",
       col.diamond="maroon",
       col.diamond.lines="maroon",
       xlab="risk ratio for muschroom-stomach cancer association",
       print.pval.Q = T,
       digits.pval.Q=4,
       print.tau2=F,
       #xlim = c(0, 1), at = c(0,0.5,1),
       backtransf = T)

```



# trim and fill : Risk ratio -----------------------------------------



```{r}
tf2 <- trimfill(m)
summary(tf2)
pdf("figs/Trimmed.pdf", width = 10, height = 10)
funnel(tf2)
dev.off()
funnel(tf2, pch = ifelse(tf2$trimfill, 1, 16),
       level = 0.9, comb.random = T,backtransf = T)
#
```




# Funnel plots : Risk ratio -----------------------------------------
```{r}

pdf("figs/FunnelPlotFinal.pdf", width = 10, height = 10)
funnel(m,xlab = "log transformed proportions",studlab = F)
dev.off()

metabias(m, method="linreg")# Egger's linear regression test

```


```{r}

metabias(m, method="rank")

```



# Plot figure 1: Overall
```{r,fig.height=3, fig.width=4, echo=FALSE,warning=FALSE}


pdf("figs/Overall_A.pdf", width = 10, height = 6)
forest(m,sortvar = TE,test.overall = T, overall= T, overall.hetstat = T,
       colgap.forest.left = "0.38 cm",print.byvar = F,
       squaresize=0.5, col.square="navy",
       col.diamond="maroon", col.diamond.lines="maroon",
       col.by="black",leftcols=("studlab"),leftlabs = c("Study"),
       rightlabs = c("RR","95% CI","Weight"), just = "center", just.addcols = "center",
       print.zval = FALSE,text.fixed="Overall (Fixed-Effect Model)",text.random="Overall (Random-Effect Model)",comb.random = T,comb.fixed = F, print.pval.Q = T,
       digits.pval.Q=4,
       print.tau2=F,
       test.overall.fixed=FALSE,test.overall.random = F)
dev.off()
#0.75  (0.61-0.92)
```


#  Begg's rank test
```{r}

metabias(m, method="rank")

```



# Plot figure 2: WHO Region
```{r,fig.height=4, fig.width=4, echo=FALSE,warning=FALSE}

mw<- update(m, byvar=WHO,print.byvar=F)

pdf("figs/WHORegions.pdf", width = 7, height = 7)
forest(mw,sortvar = TE,test.overall = FALSE, overall= F, overall.hetstat = F,
       colgap.forest.left = "0.38 cm",print.byvar = F,
       squaresize=0.5, col.square="navy",
       col.diamond="maroon", col.diamond.lines="maroon",
       col.by="black",leftcols=("studlab"),leftlabs = c("Study"),
       rightlabs = c("RR","95% CI","Weight"), just = "center", just.addcols = "center",
       print.zval = FALSE,text.fixed="Overall (Fixed-Effect Model)",text.random="Overall (Random-Effect Model)",comb.random = T,comb.fixed = F,  print.pval.Q = T,
       digits.pval.Q=4,
       print.tau2=F,
       test.overall.fixed=FALSE,test.overall.random = F)
dev.off()

```


# Plot figure 3: World Bank Income group
```{r,fig.height=4, fig.width=5, echo=FALSE,warning=FALSE}

mwb<- update(m, byvar=Income,print.byvar=F)
#pdf("figs/WorldBank.pdf", width = 15, height = 20)
forest(mwb,sortvar = TE,test.overall = T, overall= F, overall.hetstat = F,
       colgap.forest.left = "0.38 cm",print.byvar = F,
       squaresize=0.5, col.square="navy",
       col.diamond="maroon", col.diamond.lines="maroon",
       col.by="black",leftcols=("studlab"),leftlabs = c("Study"),
       rightlabs = c("RR","95% CI","Weight"), just = "center", just.addcols = "center",
       print.zval = FALSE,text.fixed="Overall (Fixed-Effect Model)",text.random="Overall (Random-Effect Model)",comb.random = T,comb.fixed = F,
       test.overall.fixed=T,test.overall.random = T)
#dev.off()

```


# Plot figure 4: Energy Intake
```{r,fig.height=4, fig.width=5, echo=FALSE,warning=FALSE}

en<- update(m, byvar=Energy_intake,print.byvar=F)
#pdf("figs/Energy.pdf", width = 15, height = 20)
forest(en,sortvar = TE,test.overall = T, overall= F, overall.hetstat = F,
       colgap.forest.left = "0.38 cm",print.byvar = F,
       squaresize=0.5, col.square="navy",
       col.diamond="maroon", col.diamond.lines="maroon",
       col.by="black",leftcols=("studlab"),leftlabs = c("Study"),
       rightlabs = c("RR","95% CI","Weight"), just = "center", just.addcols = "center",
       print.zval = FALSE,text.fixed="Overall (Fixed-Effect Model)",text.random="Overall (Random-Effect Model)",comb.random = T,comb.fixed = F, test.overall.fixed=T,test.overall.random = T)
#dev.off()

```



# Plot figure 4: Study Design
```{r,fig.height=4, fig.width=5, echo=FALSE,warning=FALSE}

sd<- update(m, byvar=Study_design,print.byvar=F)
#pdf("figs/Design.pdf", width = 15, height = 20)
forest(sd,sortvar = TE,test.overall = T, overall= F, overall.hetstat = F,
       colgap.forest.left = "0.38 cm",print.byvar = F,
       squaresize=0.5, col.square="navy",
       
       print.pval.Q = T,
       digits.pval.Q=4,
       print.tau2=F,
       
       col.diamond="maroon", col.diamond.lines="maroon",
       col.by="black",leftcols=("studlab"),leftlabs = c("Study"),
       rightlabs = c("RR","95% CI","Weight"), just = "center", just.addcols = "center",
       print.zval = FALSE,text.fixed="Overall (Fixed-Effect Model)",text.random="Overall (Random-Effect Model)",comb.random = T,comb.fixed = F,
       test.overall.fixed=T,test.overall.random = T)
#dev.off()

```


# Plot figure 4: Study Publication
```{r,fig.height=3, fig.width=5, echo=FALSE,warning=FALSE, message=F}

pub<- update(m, byvar=Study_Pub,print.byvar=F)
pdf("figs/Design.pdf", width = 7, height = 6)
forest(pub,sortvar = TE,test.overall = F, overall= F, overall.hetstat = F,
       colgap.forest.left = "0.38 cm",print.byvar = F,
       squaresize=0.5, col.square="navy",
       col.diamond="maroon", col.diamond.lines="maroon",
         print.pval.Q = T,
       digits.pval.Q=4,
       print.tau2=F,
       
       col.by="black",leftcols=("studlab"),leftlabs = c("Study"),
       rightlabs = c("RR","95% CI","Weight"), just = "center", just.addcols = "center",
       print.zval = FALSE,text.fixed="Overall (Fixed-Effect Model)",text.random="Overall (Random-Effect Model)",comb.random = T,comb.fixed = F,
       test.overall.fixed=T,test.overall.random = F)
dev.off()


```

# Plot figure 4: STOP VS NONSTOP
```{r,fig.height=5, fig.width=5, echo=FALSE,warning=FALSE, message=F}


dat$Study_Pub <-factor(dat$Study_Pub, levels = rev(levels(dat$Study_Pub)))


#df$type <- factor(df$type, levels = c("X","Y"))

sto<- update(m, byvar=dat$Study_Pub,print.byvar=F,comb.random = TRUE)


sto$bylevs <- c("StoP Project data","Other published data")


pdf("figs/Stop23.pdf", width = 8, height = 8)
forest(sto,sortvar = TE,test.overall = T, overall= T, overall.hetstat = T,bysort = F,subgroup = TRUE,
       colgap.forest.left = "0.38 cm",print.byvar = F,
       squaresize=0.5, col.square="navy",
       col.diamond="maroon", col.diamond.lines="maroon",
       print.tau2=F,  
       col.by="black",leftcols=("studlab"),leftlabs = c("Study"),
       rightlabs = c("RR","95% CI","Weight"), just = "center", just.addcols = "center",
       print.zval = FALSE,text.fixed="Overall (Fixed-Effect Model)",text.random="Overall (Random-Effect Model)",comb.random = T,comb.fixed = F,
       test.overall.fixed=F,test.overall.random = F,   print.pval.Q = T,
       digits.pval.Q=4)
dev.off()

```



# Meta-regression
```{r mean_age}


#output.metareg=metareg(m,Mean_age)
output.metareg=metareg(m,Age_centered)


meta::bubble(output.metareg,
       xlab = "Age (y)",
       col.line = "blue",
       studlab = TRUE)

```



```{r male}
output.metareg2=metareg(m,Male_Scaled)
meta::bubble(output.metareg2,
       xlab = "Male (%)",
       col.line = "blue",
       studlab = TRUE)

```


```{r H.pylori}
output.metareg3=metareg(m,hpylori_5)
meta::bubble(output.metareg3,
       xlab = "H Pylori(%)",
       col.line = "blue",
       studlab = TRUE)

```



```{r smoke Male}
output.metareg4=metareg(m, Male_Smoke)
meta::bubble(output.metareg4,
       xlab = "Male Smoking Prevelence (%)",
       col.line = "blue",
       studlab = TRUE)

```



```{r Smoke Female}

output.metareg5=metareg(m,Female_Smoke)
meta::bubble(output.metareg5,
       xlab = "Female Smoking Prevalence (%)",
       col.line = "blue",
       studlab = TRUE)
m$seTE
```



```{r Smoke Combined}

output.metareg6=metareg(m,TotalSmoke)
meta::bubble(output.metareg6,
       xlab = "Smoking Prevalence (%)",
       col.line = "blue",
       studlab = TRUE)

```


# linear trend + confidence interval

```{r age,fig.height=8, fig.width=8, echo=FALSE,warning=FALSE, message=F}

#mean(dat$Mean_age, na.rm = T)
pr=ggplot(data=dat, aes(y=TE, x=Mean_age, label=Country)) +
  #geom_point(alpha=0.8,size=10, shape=23) +
  #geom_point(aes(fill = WHO_regionP2),shape = 21,alpha=0.3, size=Tested) +
  geom_point(aes(col= WHO, size=Total)) + 
   geom_text_repel()+
  scale_color_jama()+
   scale_size(range = c(1, 30)) +
   scale_color_manual(name = "WHO Region", 
                    labels=c("Americas", "WPR","Europe", "Americas"),values = c("red", "green", "blue","orange"),na.translate =F)+
    geom_smooth(method=lm , color="black", se=F) +
  scale_x_continuous(limits = c(50, 65))+
    #facet_wrap(~factor(Income), scales = "free_x") +
 # theme_ipsum()+
  theme_bw()+
  theme(legend.position='top', 
        legend.justification='center',
        legend.direction='horizontal')

pr=pr+stat_fit_glance(method = 'lm',
       method.args = list(formula = y ~ x),  geom = 'text', 
       aes(label = paste("p=", signif(..p.value.., digits = 2), 
                      "   R-squared=", signif(..r.squared.., digits = 2), sep = "")),
       label.x = 55, label.y = 1, size = 6)


pr=pr+ xlab("Mean Age (y)")+
  ylab("Treatment effect (log risk ratio)")+
  theme(
    axis.title.x=element_text(angle=0, color='black',face = "bold",size = 30),
    axis.title.y=element_text(angle=90, color='black', face='bold', size=30),
    axis.text.x = element_text(face="bold", color="black",size=30, angle=0),
    axis.text.y = element_text(face="bold", color="black", size=30, angle=0),
    legend.text = element_text(colour="black", size=14,face="bold"),
    legend.title = element_text(colour="black", size=14,face="bold"))


pr

ggsave(pr, file = "figs/Age.png", width = 15, height = 10, type =
        "cairo-png")

```





```{r male prop,fig.height=8, fig.width=8, echo=FALSE,warning=FALSE, message=F}
pr=ggplot(data=dat, aes(y=TE, x=Perc_Male, label=Country)) +
  #geom_point(alpha=0.8,size=10, shape=23) +
  #geom_point(aes(fill = WHO_regionP2),shape = 21,alpha=0.3, size=Tested) +
  geom_point(aes(col= WHO, size=Total)) + 
   geom_text_repel()+
  scale_color_jama()+
   scale_size(range = c(1, 30)) +
   scale_color_manual(name = "WHO Region", 
                    labels=c("Americas", "WPR","Europe", "Americas"),values = c("red", "green", "blue","orange"),na.translate =F)+
    geom_smooth(method=lm , color="black", se=F) +
  scale_x_continuous(limits = c(35, 70))+
    #facet_wrap(~factor(Income), scales = "free_x") +
 # theme_ipsum()+
  theme_bw()+
  theme(legend.position='top', 
        legend.justification='center',
        legend.direction='horizontal')

pr=pr+stat_fit_glance(method = 'lm',
       method.args = list(formula = y ~ x),  geom = 'text', 
       aes(label = paste("p=", signif(..p.value.., digits = 2), 
                      "   R-squared=", signif(..r.squared.., digits = 2), sep = "")),
       label.x = 40, label.y = 1, size = 6)


pr=pr+ xlab("Male frequency  (%)")+
  ylab("Treatment effect (log risk ratio)")+
  theme(
    axis.title.x=element_text(angle=0, color='black',face = "bold",size = 30),
    axis.title.y=element_text(angle=90, color='black', face='bold', size=30),
    axis.text.x = element_text(face="bold", color="black",size=30, angle=0),
    axis.text.y = element_text(face="bold", color="black", size=30, angle=0),
    legend.text = element_text(colour="black", size=14,face="bold"),
    legend.title = element_text(colour="black", size=14,face="bold"))


pr

ggsave(pr, file = "figs/Male.png", width = 15, height = 10, type =
        "cairo-png")

```





```{r h.pylori prop,fig.height=8, fig.width=8, echo=FALSE,warning=FALSE, message=F}
pr=ggplot(data=dat, aes(y=TE, x=HPYLORI, label=Country)) +
  #geom_point(alpha=0.8,size=10, shape=23) +
  #geom_point(aes(fill = WHO_regionP2),shape = 21,alpha=0.3, size=Tested) +
  geom_point(aes(col= WHO, size=Total)) + 
   geom_text_repel()+
  scale_color_jama()+
   scale_size(range = c(1, 30)) +
   scale_color_manual(name = "WHO Region", 
                    labels=c("Americas", "WPR","Europe", "Americas"),values = c("red", "green", "blue","orange"),na.translate =F)+
    geom_smooth(method=lm , color="black", se=F) +
  scale_x_continuous(limits = c(30, 60))+
    #facet_wrap(~factor(Income), scales = "free_x") +
 # theme_ipsum()+
  theme_bw()+
  theme(legend.position='top', 
        legend.justification='center',
        legend.direction='horizontal')

pr=pr+stat_fit_glance(method = 'lm',
       method.args = list(formula = y ~ x),  geom = 'text', 
       aes(label = paste("p=", signif(..p.value.., digits = 2), 
                      "   R-squared=", signif(..r.squared.., digits = 2), sep = "")),
       label.x = 36, label.y = 1, size = 6)


pr=pr+ xlab("H.pylori prevalence (%)")+
  ylab("Treatment effect (log risk ratio)")+
  theme(
    axis.title.x=element_text(angle=0, color='black',face = "bold",size = 30),
    axis.title.y=element_text(angle=90, color='black', face='bold', size=30),
    axis.text.x = element_text(face="bold", color="black",size=30, angle=0),
    axis.text.y = element_text(face="bold", color="black", size=30, angle=0),
    legend.text = element_text(colour="black", size=14,face="bold"),
    legend.title = element_text(colour="black", size=14,face="bold"))


pr

ggsave(pr, file = "figs/h.pylori.png", width = 15, height = 10, type =
        "cairo-png")

```




```{r smoke female,fig.height=8, fig.width=8, echo=FALSE,warning=FALSE, message=F}
pr=ggplot(data=dat, aes(y=TE, x=dat$Female_Smoke, label=Country)) +
  #geom_point(alpha=0.8,size=10, shape=23) +
  #geom_point(aes(fill = WHO_regionP2),shape = 21,alpha=0.3, size=Tested) +
  geom_point(aes(col= WHO, size=Total)) + 
   geom_text_repel()+
  scale_color_jama()+
   scale_size(range = c(1, 30)) +
   scale_color_manual(name = "WHO Region", 
                    labels=c("Americas", "WPR","Europe", "Americas"),values = c("red", "green", "blue","orange"),na.translate =F)+
    geom_smooth(method=lm , color="black", se=F) +
  scale_x_continuous(limits = c(1, 10))+
    #facet_wrap(~factor(Income), scales = "free_x") +
 # theme_ipsum()+
  theme_bw()+
  theme(legend.position='top', 
        legend.justification='center',
        legend.direction='horizontal')

pr=pr+stat_fit_glance(method = 'lm',
       method.args = list(formula = y ~ x),  geom = 'text', 
       aes(label = paste("p=", signif(..p.value.., digits = 2), 
                      "   R-squared=", signif(..r.squared.., digits = 2), sep = "")),
       label.x = 4, label.y = 1, size = 6)



pr=pr+ xlab("Female Age-Standardized smoking prevalence (%)")+
  ylab("Treatment effect (log risk ratio)")+
  theme(
    axis.title.x=element_text(angle=0, color='black',face = "bold",size = 30),
    axis.title.y=element_text(angle=90, color='black', face='bold', size=30),
    axis.text.x = element_text(face="bold", color="black",size=30, angle=0),
    axis.text.y = element_text(face="bold", color="black", size=30, angle=0),
    legend.text = element_text(colour="black", size=14,face="bold"),
    legend.title = element_text(colour="black", size=14,face="bold"))


pr

ggsave(pr, file = "figs/SmokingFemale.png", width = 15, height = 10, type =
        "cairo-png")

```





```{r}

f <- dat %>%
  arrange(desc(Total)) %>%
  ggplot(aes(x = Perc_Male, y = TE)) +
  #ggplot(aes(x = Period, y = Rates, fill=Period))+  
  geom_smooth(se = F, method = "lm", size = 1.5) +
  #geom_boxplot(show.legend = F)+
  geom_point(aes(fill = WHO,  size = Total), shape = 21, alpha = .7) +
  colorblindr::scale_fill_OkabeIto(name = "WHO region") +
  scale_size(name = "Sample size")+
            # range = c(2, 10), breaks = c(10000, 50000, 100000, 150000, 200000, 250000)) +
  #annotate("text", label = "p==0.33~~R^{2}==0.00", x = 120, y = 95, parse = T) +
  geom_text_repel(aes(label = Country), size = 2.5) +
  facet_wrap(~ "Male frequency") +
  labs(x = "Study-level male frequency (%)", y = "Treatment effect (log risk ratio)")  +
  guides(fill = guide_legend(override.aes = list(size = 3.5))) +
  theme_bw(base_size = 14) +
  theme(strip.text = element_text(face = "bold", size = 13))+
    theme_bw()+
  theme(legend.position='none', 
        legend.justification='none',
        legend.direction='none')



f=f+stat_fit_glance(method = 'lm',
       method.args = list(formula = y ~ x),  geom = 'text', 
       aes(label = paste("p=", signif(..p.value.., digits = 2), 
                      "   R-squared=", signif(..r.squared.., digits = 2), sep = "")),
       label.x = 50, label.y = -1, size = 6)

f
#ggpubr::ggarrange(g1, g2, ncol = 1, common.legend = T, legend = "right")
ggsave("figs/Figure_Male.pdf", width = 10, height = 8)


```




```{r}

ff <- dat %>%
  arrange(desc(Total)) %>%
  ggplot(aes(x = Female_Smoke, y = TE)) +
  #ggplot(aes(x = Period, y = Rates, fill=Period))+  
  geom_smooth(se = F, method = "lm", size = 1.5) +
  #geom_boxplot(show.legend = F)+
  geom_point(aes(fill = WHO,  size = Total), shape = 21, alpha = .7) +
  colorblindr::scale_fill_OkabeIto(name = "WHO region") +
  scale_size(name = "Sample size")+
            # range = c(2, 10), breaks = c(10000, 50000, 100000, 150000, 200000, 250000)) +
  #annotate("text", label = "p==0.33~~R^{2}==0.00", x = 120, y = 95, parse = T) +
  geom_text_repel(aes(label = Country), size = 2.5) +
  facet_wrap(~ "Female smoking prevalence") +
  labs(x = "Female smoking prevalence (%)", y = "Treatment effect (log risk ratio)")  +
  guides(fill = guide_legend(override.aes = list(size = 3.5))) +
  theme_bw(base_size = 14) +
  theme(strip.text = element_text(face = "bold", size = 13))



ff=ff+stat_fit_glance(method = 'lm',
       method.args = list(formula = y ~ x),  geom = 'text', 
       aes(label = paste("p=", signif(..p.value.., digits = 2), 
                      "   R-squared=", signif(..r.squared.., digits = 2), sep = "")),
       label.x = 5, label.y = -1, size = 6)

ff
#ggpubr::ggarrange(g1, g2, ncol = 1, common.legend = T, legend = "right")
ggsave("figs/Figure_FemaleSmoking.pdf", width = 10, height = 8)


```


```{r}
ggpubr::ggarrange(f, ff, ncol = 2, labels = c('A', 'B'), nrow=1, common.legend = F, legend = "none")
ggsave("figs/Fig3.pdf", width = 10, height = 10)
```



